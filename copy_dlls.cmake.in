set(BINARY_DIR "${CMAKE_BINARY_DIR}/${CONFIG_NAME}/")
set(EXECUTABLES "@EXECUTABLES@")
list(TRANSFORM EXECUTABLES PREPEND "${BINARY_DIR}")
if (WIN32)
list(TRANSFORM EXECUTABLES APPEND ".exe")
endif()

# This is a fix just in case the user used a path with backslashes for CMAKE_PREFIX_PATH
file(TO_CMAKE_PATH CMAKE_PREFIX_PATH LIBRARIES_BIN_FOLDER)
string(APPEND LIBRARIES_BIN_FOLDER "/bin")

file(GET_RUNTIME_DEPENDENCIES
    RESOLVED_DEPENDENCIES_VAR LIBRARIES_RESOLVED_DEPENDENCIES
    UNRESOLVED_DEPENDENCIES_VAR LIBRARIES_UNRESOLVED_DEPENDENCIES
    EXECUTABLES ${EXECUTABLES}
    DIRECTORIES "${LIBRARIES_BIN_FOLDER}"
    POST_INCLUDE_REGEXES "^${LIBRARIES_BIN_FOLDER}"
    POST_EXCLUDE_REGEXES ".*")
message(STATUS "Resolved deps to be copied: ${LIBRARIES_RESOLVED_DEPENDENCIES}")
message(STATUS "Unresolved deps: ${LIBRARIES_UNRESOLVED_DEPENDENCIES}")
file(COPY ${LIBRARIES_RESOLVED_DEPENDENCIES} DESTINATION "${BINARY_DIR}" FOLLOW_SYMLINK_CHAIN)